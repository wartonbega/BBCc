{
  "scopeName": "source.bbc",
  "patterns": [
    {
      "name": "comment.line.bbc",
      "match": "//.*$"
    },
    {
      "name": "string.quoted.double.bbc",
      "begin": "\"",
      "end": "\"",
      "patterns": [
        {
          "name": "constant.character.escape.bbc",
          "match": "\\\\."
        }
      ]
    },
    {
      "name": "string.quoted.single.bbc",
      "begin": "'",
      "end": "'",
      "patterns": [
        {
          "name": "constant.character.escape.bbc",
          "match": "\\\\."
        }
      ]
    },
    {
      "name": "constant.numeric.bbc",
      "match": "\\b[0-9]+\\b"
    },
    {
      "name": "constant.language.bbc",
      "match": "\\b(true|false|null)\\b"
    },
    {
      "name": "keyword.control.bbc",
      "match": "\\b(if|elif|else|while|for)\\b"
    },
    {
      "name": "keyword.other.bbc",
      "match": "\\b(let|free)\\b"
    },
    {
      "name": "support.function.bbc",
      "match": "\\b(print|println)\\b"
    },
    {
      "comment": "Function with type parameters: func<T> name(",
      "begin": "\\b(func)\\s*(<)",
      "beginCaptures": {
        "1": {
          "name": "storage.type.function.bbc"
        },
        "2": {
          "name": "punctuation.bracket.angle.bbc"
        }
      },
      "end": "(>)\\s*([a-zA-Z_][a-zA-Z0-9_]*)\\s*(?=\\()",
      "endCaptures": {
        "1": {
          "name": "punctuation.bracket.angle.bbc"
        },
        "2": {
          "name": "entity.name.function.bbc"
        }
      },
      "patterns": [
        {
          "name": "entity.name.type.parameter.bbc",
          "match": "\\b[a-zA-Z_][a-zA-Z0-9_]*\\b"
        },
        {
          "name": "punctuation.separator.bbc",
          "match": "[:,]"
        }
      ]
    },
    {
      "comment": "Function definition: func name(",
      "match": "\\b(func)\\s+([a-zA-Z_][a-zA-Z0-9_]*)\\s*(?=\\()",
      "captures": {
        "1": {
          "name": "storage.type.function.bbc"
        },
        "2": {
          "name": "entity.name.function.bbc"
        }
      }
    },
    {
      "comment": "Anonymous function: func(",
      "name": "storage.type.function.bbc",
      "match": "\\bfunc\\b"
    },
    {
      "comment": "Struct definition: struct Name",
      "match": "\\b(struct)\\s+([a-zA-Z_][a-zA-Z0-9_]*)",
      "captures": {
        "1": {
          "name": "storage.type.struct.bbc"
        },
        "2": {
          "name": "entity.name.type.bbc"
        }
      }
    },
    {
      "comment": "Enum definition: enum Name",
      "match": "\\b(enum)\\s+([a-zA-Z_][a-zA-Z0-9_]*)",
      "captures": {
        "1": {
          "name": "storage.type.enum.bbc"
        },
        "2": {
          "name": "entity.name.type.bbc"
        }
      }
    },
    {
      "comment": "Type annotation with error and pointers: !TypeName",
      "match": "(!)?(Int|Bool|Char|Void|String)\\b",
      "captures": {
        "1": {
          "name": "keyword.operator.error.bbc"
        },
        "2": {
          "name": "storage.type.primitive.bbc"
        }
      }
    },
    {
      "comment": "Custom type with error and pointers: !**MyType",
      "match": "(!)?([A-Z][a-zA-Z0-9_]*)\\b",
      "captures": {
        "1": {
          "name": "keyword.operator.error.bbc"
        },
        "2": {
          "name": "entity.name.type.bbc"
        }
      }
    },
    {
      "comment": "Function call: name(",
      "match": "\\b([a-z_][a-zA-Z0-9_]*)\\s*(?=\\()",
      "captures": {
        "1": {
          "name": "entity.name.function.call.bbc"
        }
      }
    },
    {
      "comment": "Struct init: @Name{",
      "match": "(@)\\s*([a-zA-Z_][a-zA-Z0-9_]*)\\s*(?=\\{)",
      "captures": {
        "1": {
          "name": "keyword.operator.at.bbc"
        },
        "2": {
          "name": "entity.name.type.bbc"
        }
      }
    },
    {
      "comment": "Anonymous struct init: @{",
      "name": "keyword.operator.at.bbc",
      "match": "@(?=\\s*\\{)"
    },
    {
      "comment": "Error check operator: ? errname",
      "match": "(\\?)\\s*([a-zA-Z_][a-zA-Z0-9_]*)",
      "captures": {
        "1": {
          "name": "keyword.operator.error-check.bbc"
        },
        "2": {
          "name": "variable.other.error.bbc"
        }
      }
    },
    {
      "comment": "Method call: .methodname(",
      "match": "(\\.)([a-zA-Z_][a-zA-Z0-9_]*)\\s*(?=\\()",
      "captures": {
        "1": {
          "name": "punctuation.accessor.bbc"
        },
        "2": {
          "name": "entity.name.function.call.bbc"
        }
      }
    },
    {
      "comment": "Member access: .fieldname",
      "match": "(\\.)([a-zA-Z_][a-zA-Z0-9_]*)",
      "captures": {
        "1": {
          "name": "punctuation.accessor.bbc"
        },
        "2": {
          "name": "variable.other.member.bbc"
        }
      }
    },
    {
      "name": "keyword.operator.arrow.bbc",
      "match": "->"
    },
    {
      "name": "keyword.operator.comparison.bbc",
      "match": "==|!=|<=|>="
    },
    {
      "name": "keyword.operator.bbc",
      "match": "[=+\\-*/<>!?@]"
    },
    {
      "name": "punctuation.comma.bbc",
      "match": ","
    },
    {
      "name": "punctuation.colon.bbc",
      "match": ":"
    },
    {
      "name": "punctuation.bracket.bbc",
      "match": "[\\[\\]]"
    }
  ]
}